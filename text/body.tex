\documentclass[tcc]{subfiles}

\begin{document}
\textual

\subfile{text/body/introduction}

\chapter{Literature review}
\epigraph{To fight and conquer in all our battles is not supreme excellence; supreme excellence consists in breaking the enemy's resistance without fighting.}{\em(Sun Tzu)}

The simulation of a gas turbine engine is fundamentally a multidisciplinary matter.
It encompass not only the fields of turbomachinery and compressible flow, 
but also those of dynamical systems and numerical analysis. 

\section{Basic compressible flow relations}
There are many consolidated references on compressible flow. 
This section will only list the relations essential to the development in \cref{sec:methods}. 
The reader should refer to \textcite{Anderson, Shapiro} for a more in depth discussion.

\section{Euler's equation}
\label{sec:euler_equation}
Euler's equation is a consequence of the application of the laws of conservation of angular momentum and energy to a turbomachine. It is the cornerstone of performance calculation for compressor and turbines, and is derived in any textbook on turbomachinery \cite{Lakshminarayana1996, Dixon1998, Schobeiri2004, Hill1991, Logan2003, Baskharone2006}. Due to its importance, this equation will be briefly derived here.

From the conservation of angular momentum, 

\begin{equation}
    \vec{\acs{torque}} = \dot{m} (\vec{r_2}\cross\vec{V_2} - \vec{r_1}\cross\vec{V_1}) 
\end{equation}

Multiplying both sides by the rotational speed ($\omega$)

\begin{equation}
    \acs{power} = \vec{\omega}\cdot\vec{\acs{torque}} 
                = \dot{m} \vec{\omega} \cdot (\vec{r_2}\cross\vec{V_2} - \vec{r_1}\cross\vec{V_1}) 
\end{equation}

Assuming that the system is adiabatic and using the first law of thermodynamics, the specific enthalpy change is given by

\begin{equation}
    \Delta h = \frac{\acs{power}}{\dot{m}} 
             = \vec{\omega} \cdot (\vec{r_2}\cross\vec{V_2} - \vec{r_1}\cross\vec{V_1}) 
\end{equation}

\begin{equation}
    \Delta h = \omega (r_2 {V_u}_2 - r_1 {V_u}_1) 
\end{equation}

\begin{equation}
    \label{eqn:euler}
    \Delta h = U_2 {V_u}_2 - U_1 {V_u}_1 
\end{equation}

\subsection{Euler's equation for a centrifugal compressor}

It is useful to write the absolute tangential velocity at the compressor exit (${V_u}_2$)
as a function of the radial relative velocity (${W_r}_2$),
since the latter is more closely related to the mass flow 
(i.e. $\dot{m} = \rho {W_r}_2 A_2$, where $A_2$ is the ring shaped exit area of the compressor)

From the velocity triangle in figure X, assuming that the flow exits tangential to the blade surface,
\begin{equation}
    \label{eqn:V_u_2}
    {V_u}_2 = U_2 - {W_r}_2 \tan\beta_2
\end{equation}

Due to aerodynamic blockage at the tip and flow distortions caused by viscous efects, flow diffusion, clearences and blade aspect ratio,
${V_u}_2$ is actually smaller than what is predicted by \cref{eqn:V_u_2}.
This is accounted for by the \acf{impeller_distortion_factor}\index{impeller distortion factor}.
Furthermore, the flow does not exit perfectly tangential to the blade surface, and this is accounted by the \acf{slip_factor} \cite{Wiesner1967,Aungier1995}.
The corrected equation for the absolute tangential velocity is then

\begin{equation}
    \label{eqn:V_u_2_corrected}
    {V_u}_2 = \acs{slip_factor}(U_2 - \acs{impeller_distortion_factor}{W_r}_2 \tan\beta_2)
\end{equation}

Substituting \cref{eqn:V_u_2_corrected} in \cref{eqn:euler} and dividing both sides by ${U_2^2}$, we have

\begin{equation}
    \acs{load_coef} = \acs{slip_factor}(1-\acs{impeller_distortion_factor}\acs{flow_coef}_2\tan\beta_2) - \frac{U_1 {V_u}_1}{U_2^2} 
\end{equation}

where $\phi_2 \triangleq \frac{\dot{m}}{A_2 \rho_2 U_2} = \frac{W_{2r}}{U_2}$ is the flow parameter\index{flow parameter} at the compressor exit
and $\psi \triangleq \frac{\Delta h}{U_2^2}$

The second term accounts for pre-whirl\index{pre-whirl} in the flow entering the compressor, e.g due to \ac{IGV}.
In the case of no pre-whirl, ${V_u}_1 = 0$, thus 

\begin{equation}
    \label{eqn:euler}
    \acs{load_coef} = \acs{slip_factor}(1-\acs{impeller_distortion_factor}\acs{flow_coef}_2\tan\beta_2)  
\end{equation}

\subsection{Euler's equation for an axial turbine}

\section{Loss models for centrifugal compressors}
\label{sec:compressor_losses}
Euler's equation is only valid for isentropic flow. 
For a real flow, corrections must be introduced to account for the generation of entropy in many parts of the compression process. 
These so called ``losses'' are modelled in literature as enthalpy corrections 
for the Euler equation considering both the \emph{actual} process and the \emph{isentropic} process 
that would generate the same increase in pressure as the real process.
Each of these losses can be categorized as either \emph{internal} or \emph{parasitic}.
Internal losses are those that happen inside the fluid main flow, and result in a decrease in the resulting pressure ratio.
Parasitic losses are the ones who happen outside the fluid main flow, 
and result in a increase in the temperature ratio through the compressor \cite{Galvas1973}.
Using these definitions, the actual and isentropic enthalpy changes through the compressor can be calculate as follows

\begin{align}
    \Delta h_{\text{actual}} &= \Delta h_{\text{euler}} + \sum_{\substack{
                                                            \text{parasitic} \\ 
                                                            \text{losses}
                                                        }}
                                                          \Delta h \\
    \Delta h_{\text{isen}}  &= \Delta h_{\text{euler}} - \sum_{\substack{
                                                            \text{internal} \\ 
                                                            \text{losses}
                                                        }}
                                                          \Delta h
\end{align}

The temperature and pressure ratios are given by
\begin{align}
    \frac{T_{03}}{T_{02}} &= 1 + \frac{\Delta h_{\text{actual}}}{c_p T_{02}} \\
    \frac{P_{03}}{P_{02}} &= \left( 1 + \frac{\Delta h_{\text{isen}}}{c_p T_{02}}\right)^{\frac{\gamma}{\gamma-1}}
\end{align}

The isentropic and polytropic efficiencies can then be readly calculated as
\begin{align}
    \eta_t &= \frac{\Delta h_{\text{isen}}}{\Delta h_{\text{actual}}}\\
    \eta_p &= \frac{\gamma-1}{\gamma} \left(\frac{\log\frac{P_{02}}{P_{01}}}
                                                 {\log\frac{T_{02}}{T_{01}}}
                                     \right)
\end{align}

\textcite{Aungier1995} criticises this calculation because the losses should be regarded as changes in entropy, and not in enthalphy. Despite this shortcomming, the enthalphy approach is widely used.

The losses generally accounted for are listed in \cref{tbl:compressor_loss_mechanisms}.
\begin{table}
\caption{Loss mechanisms for a centrifugal compressor}
\label{tbl:compressor_loss_mechanisms}
\hrule
\begin{multicols}{2}
\begin{compactitem}
    \item[] \textbf{Internal}
    \item Incidence loss (in the impeller and diffuser)
    \item Blade loading loss
    \item Skin friction loss
    \item Clearance loss
    \item Mixing loss
    \item Vaneless diffuser loss
    \columnbreak
    \item[] \textbf{Parasitic}
    \item Disc friction loss
    \item Recirculation loss
    \item Leakage loss
\end{compactitem}
\end{multicols}
\hrule
\source{\cite{Oh1997}}
\end{table}

A detailed discussion of each loss mechanism is beyond the scope of this work; 
the interested reader should refer to \textcite{Cumpsty2004}. 

Semi-empirical models are available to predict each individual loss based on compressor geometry and flow conditions. 
In particular, \textcite{Oh1997} did a review of various loss models for each loss mechanism and selected an optimal set.

\section{Loss models for axial turbines}
Carter's rule
Ainsley

\section{Engine simulation (dynamic and static)}
\subsection{Turbojet thermodynamic cycle}
\subsection{What is a component map/characteristic}
\subsection{Available programs}
\section{Flow stability: compressor surge}
\section{Numerical aspects}
\subsection{Nonlinear solvers}
\subsubsection{Gradient based solvers}
\subsubsection{Homotopic solvers}
\subsection{\ac{ODE} solvers}
\subsubsection{Explicit solvers}
\subsubsection{Implicit solvers}
\subsection{Graph theory}
\subsubsection{Viewing a grid/mesh as a graph}
\subsubsection{Breadth first search}

\chapter{Methods}
\label{sec:methods}
\epigraph{It's not denial. \\ I'm just selective about the reality I accept.}{Bill Watterson}
Assumptions: ideal gas
\section{Compressor model}

The incidence loss model used assumes that all kinectic energy from the velocity components
normal to the inducer and diffuser blades is lost \cite{Stanitz1953}.
All other loss models used were suggested by the comparative study of \textcite{Oh1997}, 
and will not be discussed here.

\subfile{text/body/compressor_map}

From the Buckinham $\Pi$ Theorem \cite{Buckingham1914}, 
it can be shown that the compressor behaviour is a function of only three parameters, 
namely the \acl{MFP}, the \acl{M0rotor}, the \acl{gam} and the \acl{Re}. 
For a centrifugal compressor, this quantities are defined respectively as follows

\begin{align}
    \acs{MFP} &\triangleq \MFP{1} = \MFPalt{1} \\
    \acs{M0rotor} &\triangleq \frac{U_2}{\sqrt{\gamma R T_{01}}} \\
    \gamma &\triangleq \frac{c_p}{c_v} \\
    \acs{Re} &
\end{align}

In particular, the \acl{MFP} is a function of the Mach number and the specific heat ratio,
 i.e.\
\begin{equation}
    \label{eqn:mfp2mach}
    \acs{MFP}(M,\gamma) = M \left( 1 + \frac{\gamma-1}{2}M^2\right)^{-\frac{\gamma+1}{2(\gamma-1)}}
\end{equation}
While there is no closed form inverse for this function, it is invertible and the inverse can be easily computed nummerically, e.g.\ by a newton scheme \cite{Der1974}.

According to \textcite{walsh2004gas},
 the influence of the \acl{Re} in the system behaviour is only of second order.

To write Euler's equation \cref{eqn:euler} in terms of these parameters, suffices to rewrite $\phi_2$ and $\psi$ as a function of them. Thus
\begin{multline}
    \label{eqn:phi2_dimensionless}
    \phi_2 = \frac{W_{2r}}{U_2} 
           = \frac{\frac{\dot{m}}{\rho_2 A2}}{\acs{M0rotor} a_{01}}
           = \frac{\MFPalt{2}}{\acs{M0rotor}} \frac{a_{02}}{a_{01}} \stagdensratio{2} \\ 
           = \frac{\acs{MFP}_2}{\acs{M0rotor}} \sqrt{\frac{T_{02}}{T_{01}}} \stagdensratio{2}
\end{multline}
The value of $M_2$ can be obtained from $\acs{MFP}_2$ using \cref{eqn:mfp2mach}, while the latter is given by
\begin{equation}
    \label{eqn:mfp2mfp2}
    \acs{MFP}_2 \triangleq \MFP{2} = \acs{MFP} \frac{A_1}{A_2} \frac{P_{01}}{P_{02}} \sqrt{\frac{T_{02}}{T_{01}}}
\end{equation}
Notice that \cref{eqn:mfp2mfp2} makes no assumption of the process 1--2 being isentropic. $\acs{MFP}_2$ can be used along with \acs{MFP} to check for choking.

The load coefficient is given by
\begin{equation}
    \acs{load_coef}\triangleq \frac{\Delta h}{U_2^2}
                      = \frac{c_p(T_{02}-T_{01})}{U_2^2}
                      = \frac{\frac{c_p(T_{02}-T_{01})}{\gamma R T_{01}}}
                                    {\acs{M0rotor}^2}
                      = \frac{\frac{T_{02}}{T_{01}}-1}
                                  {\acs{M0rotor}^2}
                        \left(\frac{1}{\gamma-1}\right)
\end{equation}

At this point the loss models discussed in \cref{sec:compressor_losses} are introduced, 
and the values of $\acs{load_coef}_{2\text{actual}}$ and $\acs{load_coef}_{2\text{isen}}$ are obtained.
The temperatures and pressure ratio can then be readly calculate from
\begin{align}
    \label{eqn:psi2Tratio}
    \frac{T_{02}}{T_{01}} &= (\gamma - 1)\psi_{2\text{actual}} \acs{M0rotor}^2 + 1 \\
    \label{eqn:psi2Pratio}
    \frac{P_{02}}{P_{01}} &= \left[(\gamma - 1)\psi_{2\text{isen}} \acs{M0rotor}^2 + 1\right]^\frac{\gamma}{\gamma-1}
\end{align}


\section{Turbine model}

\subfile{text/body/nozzle}


\section{Engine equilibrium model}
\section{Engine dynamical model}
\section{Surge model}
\section{Numerical aspects}
\subsection{Nonlinear solvers and convergence}
\subsection{Generating a parametric surface from a nonlinear system}
\subsubsection{Initial guess propagation}

\chapter{Results and discussion}
\section{Compressor map}
\includegraphics{src/mapv1.pdf}
\section{Turbine map}
\section{Work line}
\includegraphics{src/working_line_compressor.pdf}
\section{Dynamical simulation}

\subfile{text/body/materials_and_methods}
\subfile{text/body/dynamic_engine_model}
\subfile{text/body/controller_model}
\subfile{text/body/conclusion}

\end{document}
